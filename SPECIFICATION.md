# Life App 仕様書 (最終確定版 V3: 内省特化・メディア連携あり)

## 1. アプリ概要

* **名称**: **Life App**
* **目的**: 構造化された日記とロケーション情報に特化し、ユーザーの深い内省と行動の記録を支援するモバイルアプリケーション。
* **開発手法**: 使用駆動開発（BDD）

---

## 2. ログの構造と機能（コアデータモデル）

### 2.1 ログの種類（2種類）

| ログタイプ | 主な目的 | 記録項目 | 備考 |
| :--- | :--- | :--- | :--- |
| **日記 (Journal)** | 内省と自由な記述 | ひとこと、構造化された本文、自由記述スペース | コアとなる記録形式 |
| **ロケーション (Location)** | 移動経路と訪問スポットの記録 | 移動経路（自動/手動）、特定スポット、訪問時間 | 日記ログに紐づけられることも可能 |

### 2.2 日記ログの詳細構造

| 項目 | 必須/任意 | 内容 |
| :--- | :--- | :--- |
| **ひとこと** | 任意 | その日の要約や簡単なコメント。 |
| **最もよかったこと** | 必須 | その日の中で最もポジティブだった出来事。 |
| **よくなかったこと** | 必須 | 改善の余地がある、あるいはネガティブだった出来事。 |
| **うれしかったこと** | 必須 | 感謝や喜びを感じた出来事。 |
| **明日の目標** | 必須 | 次の日の具体的な行動目標。 |
| **自由記述スペース**| 任意 | 上記項目に当てはまらない、自由な文章。 |

### 2.3 メディア連携

* **日記ログ**と**ロケーションログ**に対し、その日に撮影した**画像（写真）**や**動画**を**紐づける**機能。

---

## 3. 主要な機能要件

| 機能カテゴリ | 詳細 |
| :--- | :--- |
| **記録 (Entry)** | 日記ログとロケーションログを日時指定で記録できる。過去ログの編集・削除機能。 |
| **表示・検索** | 全ログを統合した**時系列タイムライン**表示。日付範囲、ログの種類、キーワードによる**フィルタ検索**。 |
| **分析・レポート** | 日記の**キーワード頻度**や**ロケーション訪問頻度**の分析に特化。心情分析は、日記のテキストマイニングに依存する。 |
| **振り返り通知** | **ランダムな過去の日記ログ**を**不定期**に通知するリマインダー機能。通知頻度を設定可能。 |
| **設定・管理** | データエクスポート（CSV/JSON）。 |

---

## 4. 開発指示用 Gherkin シナリオ集

### シナリオ 1: 基本的な日記ログの記録

```gherkin
フィーチャ: 日記機能

  背景:
    ユーザーはLife Appを起動し、記録画面を開いている。

  シナリオ: ユーザーは構造化された本文で日記を記録し、確認できる
    前提 ユーザーは「日記ログ」の入力画面を開いている
    もし ユーザーが**ひとこと**に「充実した一日」と入力し
    かつ **最もよかったこと**に「懸念事項だった顧客との会議が成功した」と入力し
    かつ **よくなかったこと**に「帰りの電車で傘を忘れた」と入力し
    かつ **うれしかったこと**に「妻がサプライズで好物のケーキを買ってきてくれた」と入力し
    かつ **明日の目標**に「午前中にタスクAを完了させる」と入力し
    かつ 「記録」ボタンをタップする
    ならば 画面に「ログが記録されました」と表示される
    かつ タイムライン画面でその日のログとして、**ひとこと**と本文の一部を含む記録された日記が表示されていること
```

### シナリオ 2: ロケーションログの記録

```gherkin
フィーチャ: ロケーションとメディア連携

  背景:
    ユーザーは新しい日記ログを作成中である。

  シナリオ: 日記ログに特定スポットの位置情報と写真を紐づける
    前提 ユーザーは「日記ログ」の入力画面を開いている
    もし ユーザーが**ひとこと**と本文（必須項目）を入力し
    かつ 「ロケーション追加」をタップして「東京タワー」を特定スポットとして追加し
    かつ **「写真・動画追加」をタップしてギャラリーから1枚の写真を選択し**
    かつ 「記録」ボタンをタップする
    ならば 画面に「ログが記録されました」と表示される
    かつ タイムライン上のログには「東京タワー」の位置情報アイコンが表示されていること
    かつ **ログの詳細画面で、紐づけられた写真が確認できること**
```

### シナリオ 3: 過去ログの振り返り通知の設定

```gherkin
フィーチャ: 過去ログの振り返り通知

  背景:
    ユーザーはLife Appの設定画面を開いている。

  シナリオ: ユーザーはランダムな過去ログの通知頻度を設定できる
    前提 ユーザーは「通知設定」の項目を開いている
    もし ユーザーが「過去ログの振り返り通知」をONにし
    かつ 通知頻度を「週に2回」に設定する
    ならば アプリは設定に基づき、週に2回ランダムな過去の**日記ログ**を通知すること
    かつ ユーザーが通知をタップした際、該当のログの詳細画面に遷移すること
```
